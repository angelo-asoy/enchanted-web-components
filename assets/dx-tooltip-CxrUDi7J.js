import{n as P,t as B,D as z,v as C}from"./dx-ac-base-element-iuhCq_Hv.js";import{r as m}from"./state-Bna1m6sV.js";import{e as W}from"./dx-button-F1O_6JWA.js";import{E as S,x as b}from"./iframe-CBB3s6n5.js";import{T as t,F as V,E as p,z as E}from"./cssClassEnums-flPS6Iko.js";var c=(e=>(e.ACCEPT="accept",e.CROSS="cross",e.PRIMARY="primary",e.MIXED="mixed",e))(c||{});const $=new Map([[t.TOOLTIP_TOP,[t.TOOLTIP_TOP,t.TOOLTIP_BOTTOM,t.TOOLTIP_RIGHT,t.TOOLTIP_LEFT,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM_END,t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT_END,t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT_END,t.TOOLTIP_TOP_START,t.TOOLTIP_TOP_END]],[t.TOOLTIP_TOP_START,[t.TOOLTIP_TOP_START,t.TOOLTIP_TOP,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM,t.TOOLTIP_RIGHT,t.TOOLTIP_LEFT,t.TOOLTIP_BOTTOM_END,t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT_END,t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT_END,t.TOOLTIP_TOP_END]],[t.TOOLTIP_TOP_END,[t.TOOLTIP_TOP_END,t.TOOLTIP_TOP,t.TOOLTIP_BOTTOM_END,t.TOOLTIP_BOTTOM,t.TOOLTIP_RIGHT,t.TOOLTIP_LEFT,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT_END,t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT_END,t.TOOLTIP_TOP_START]],[t.TOOLTIP_BOTTOM,[t.TOOLTIP_BOTTOM,t.TOOLTIP_TOP,t.TOOLTIP_RIGHT,t.TOOLTIP_LEFT,t.TOOLTIP_TOP_START,t.TOOLTIP_TOP_END,t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT_END,t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT_END,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM_END]],[t.TOOLTIP_BOTTOM_START,[t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM,t.TOOLTIP_TOP_START,t.TOOLTIP_TOP,t.TOOLTIP_RIGHT,t.TOOLTIP_LEFT,t.TOOLTIP_TOP_END,t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT_END,t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT_END,t.TOOLTIP_BOTTOM_END]],[t.TOOLTIP_BOTTOM_END,[t.TOOLTIP_BOTTOM_END,t.TOOLTIP_BOTTOM,t.TOOLTIP_TOP_END,t.TOOLTIP_TOP,t.TOOLTIP_RIGHT,t.TOOLTIP_LEFT,t.TOOLTIP_TOP_START,t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT_END,t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT_END,t.TOOLTIP_BOTTOM_START]],[t.TOOLTIP_RIGHT,[t.TOOLTIP_RIGHT,t.TOOLTIP_LEFT,t.TOOLTIP_TOP,t.TOOLTIP_BOTTOM,t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT_END,t.TOOLTIP_TOP_START,t.TOOLTIP_TOP_END,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM_END,t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT_END]],[t.TOOLTIP_RIGHT_START,[t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT,t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT,t.TOOLTIP_TOP,t.TOOLTIP_BOTTOM,t.TOOLTIP_LEFT_END,t.TOOLTIP_TOP_START,t.TOOLTIP_TOP_END,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM_END,t.TOOLTIP_RIGHT_END]],[t.TOOLTIP_RIGHT_END,[t.TOOLTIP_RIGHT_END,t.TOOLTIP_RIGHT,t.TOOLTIP_LEFT_END,t.TOOLTIP_LEFT,t.TOOLTIP_TOP,t.TOOLTIP_BOTTOM,t.TOOLTIP_LEFT_START,t.TOOLTIP_TOP_START,t.TOOLTIP_TOP_END,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM_END,t.TOOLTIP_RIGHT_START]],[t.TOOLTIP_LEFT,[t.TOOLTIP_LEFT,t.TOOLTIP_RIGHT,t.TOOLTIP_TOP,t.TOOLTIP_BOTTOM,t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT_END,t.TOOLTIP_TOP_START,t.TOOLTIP_TOP_END,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM_END,t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT_END]],[t.TOOLTIP_LEFT_START,[t.TOOLTIP_LEFT_START,t.TOOLTIP_LEFT,t.TOOLTIP_RIGHT_START,t.TOOLTIP_RIGHT,t.TOOLTIP_TOP,t.TOOLTIP_BOTTOM,t.TOOLTIP_RIGHT_END,t.TOOLTIP_TOP_START,t.TOOLTIP_TOP_END,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM_END,t.TOOLTIP_LEFT_END]],[t.TOOLTIP_LEFT_END,[t.TOOLTIP_LEFT_END,t.TOOLTIP_LEFT,t.TOOLTIP_RIGHT_END,t.TOOLTIP_RIGHT,t.TOOLTIP_TOP,t.TOOLTIP_BOTTOM,t.TOOLTIP_RIGHT_START,t.TOOLTIP_TOP_START,t.TOOLTIP_TOP_END,t.TOOLTIP_BOTTOM_START,t.TOOLTIP_BOTTOM_END,t.TOOLTIP_LEFT_START]]]),U=e=>$.get(e)||[],M=(e,T,i,s)=>{const o=s?T.right-i:T.left,O=s?T.left:T.right-i;return e.endsWith("-start")?o:e.endsWith("-end")?O:T.left+(T.width-i)/2},A=(e,T,i)=>e.endsWith("-start")?T.top:e.endsWith("-end")?T.bottom-i:T.top+(T.height-i)/2,X=(e,T,i,s,o)=>{const O=T.left+T.width/2,n=T.top+T.height/2;switch(!0){case e.startsWith("tooltip-top"):return{left:M(e,T,i.width,o),top:T.top-i.height-s};case e.startsWith("tooltip-bottom"):return{left:M(e,T,i.width,o),top:T.bottom+s};case e.startsWith("tooltip-right"):return{left:T.right+s,top:A(e,T,i.height)};case e.startsWith("tooltip-left"):return{left:T.left-i.width-s,top:A(e,T,i.height)};default:return{left:O,top:n}}},g=new Map,w=(e,T,i,s,o,O)=>{const n=`${e}-${T}-${i.width}-${i.height}-${s.width}-${s.height}-${o}`;if(g.has(n))return g.get(n);const h=Math.max(0,s.left+o+O-e),r=Math.max(0,s.top+o+O-T),_=Math.max(0,e+i.width-(s.right-o-O)),L=Math.max(0,T+i.height-(s.bottom-o-O)),d={left:h,top:r,right:_,bottom:L,total:h+r+_+L};return g.set(n,d),d},u=e=>e.startsWith("tooltip-top")||e.startsWith("tooltip-bottom"),N=(e,T,i)=>{const s=u(e)?T.top>i||T.bottom>i:T.left>i||T.right>i,o=u(e)?T.left>i||T.right>i:T.top>i||T.bottom>i;return!s&&!o?c.ACCEPT:!s&&o?c.CROSS:s&&!o?c.PRIMARY:c.MIXED},D=(e,T,i,s,o)=>{const O=s.left+o,n=s.right-o-i.width,h=s.top+o,r=s.bottom-o-i.height;return{left:Math.min(Math.max(e,O),n),top:Math.min(Math.max(T,h),r)}},Y=(e,T,i,s,o)=>{if(u(e)){const O=s.left+o,n=s.right-o-i.width;return{left:Math.min(Math.max(T.left,O),n),top:T.top}}else{const O=s.top+o,n=s.bottom-o-i.height;return{left:T.left,top:Math.min(Math.max(T.top,O),n)}}},H=(e,T)=>{const i=u(e)?T.top+T.bottom:T.left+T.right,s=u(e)?T.left+T.right:T.top+T.bottom;return i*2+s},j=(e,T,i,s,o,O,n,h)=>{let r=X(e,T,i,o,h),_=w(r.left,r.top,i,n,s,O),L=N(e,_,O);return L===c.ACCEPT?{accept:!0,left:r.left,top:r.top,placement:e,overflows:_}:L===c.CROSS&&(r=Y(e,r,i,n,s),_=w(r.left,r.top,i,n,s,O),L=N(e,_,O),L===c.ACCEPT)?{accept:!0,left:r.left,top:r.top,placement:e,overflows:_}:{accept:!1,left:r.left,top:r.top,placement:e,overflows:_}},x=(e,T)=>({left:Math.round(e),top:Math.round(T)}),F=(e,T,i,s,o,O,n,h)=>{const r=U(e),_=[];for(const f of r){const I=j(f,T,i,s,o,O,n,h);if(I.accept){const y=D(I.left,I.top,i,n,s),R=x(y.left,y.top);return{left:R.left,top:R.top,placement:I.placement}}_.push(I)}_.sort((f,I)=>H(f.placement,f.overflows)-H(I.placement,I.overflows));const L=_[0],d=D(L.left,L.top,i,n,s),v=x(d.left,d.top);return{left:v.left,top:v.top,placement:L.placement}},G=e=>{let T=e.parentElement;for(;T;){const i=window.getComputedStyle(T);if(i.transform&&i.transform!=="none")return T;T=T.parentElement}return null},k=e=>{const T=window.getComputedStyle(e),i=T.getPropertyValue("transform")||T.getPropertyValue("-webkit-transform");if(i==="none")return{scale:1,translateX:0,translateY:0};const s=new DOMMatrix(i),o=s.a,O=s.e,n=s.f;return{scale:o,translateX:O,translateY:n}};var q=Object.defineProperty,K=Object.getOwnPropertyDescriptor,a=(e,T,i,s)=>{for(var o=s>1?void 0:s?K(T,i):T,O=e.length-1,n;O>=0;O--)(n=e[O])&&(o=(s?n(T,i,o):n(o))||o);return s&&o&&q(T,i,o),o};let l=class extends z{constructor(){super(...arguments),this.show=!1,this.tooltipSize=V.TOOLTIP_SMALL,this.tooltipType=p.TOOLTIP_SINGLE_LINE,this.placement=t.TOOLTIP_BOTTOM,this.gap=4,this.multiLineMaxWidth=300,this.viewportPadding=4,this.minimumWidth=0,this.isRTL=!1,this.componentId=C(),this.softMargin=8,this.isTargetVisible=!0,this.rafId=null,this._targetIntersectionObserver=null,this._targetResizeObserver=null,this._tooltipResizeObserver=null,this._ancestorResizeObserver=null,this._targetDismissTimer=null,this._scheduleTooltipPositionUpdateHandler=()=>this.scheduleTooltipPositionUpdate(),this.scheduleTooltipPositionUpdate=()=>{this.rafId===null&&(this.rafId=requestAnimationFrame(async()=>{this.rafId=null,await this.updateTooltipPosition()}))},this.onTargetVisibility=e=>{const T=e[0],i=T.isIntersecting&&T.intersectionRatio>=.01;this.isTargetVisible=i,i?this._targetDismissTimer&&(clearTimeout(this._targetDismissTimer),this._targetDismissTimer=null):this._targetDismissTimer||(this._targetDismissTimer=window.setTimeout(()=>{this._targetDismissTimer=null,this.isTargetVisible=!1,this.show=!1},150))},this.handleMouseOver=e=>{e.stopPropagation(),this.show=!0},this.handleMouseLeave=e=>{e.stopPropagation(),this.show=!1},this.handleFocus=e=>{e.stopPropagation(),this.show=!0},this.handleBlur=e=>{e.stopPropagation(),this.show=!1},this.updateTooltipPosition=async()=>{if(!this.tooltipElement||!this.targetElement||!this.show)return;const e=this.targetElement.getBoundingClientRect(),T=this.readVisibleViewportBox();let i=this.isTargetElementVisible(e,T,this.viewportPadding);if(!i){this.tooltipElement.style.visibility="hidden";return}await this.runSizing(this.placement,this.targetElement.getBoundingClientRect(),T,this.viewportPadding);const s=this.tooltipElement.getBoundingClientRect();let o=F(this.placement,this.targetElement.getBoundingClientRect(),s,this.viewportPadding,this.gap,this.softMargin,T,this.isRTL);if(this.placement.startsWith("tooltip-left")||this.placement.startsWith("tooltip-right")&&this.placement!==o.placement){await this.runSizing(o.placement,e,T,this.viewportPadding);const r=this.tooltipElement.getBoundingClientRect();o=F(o.placement,this.targetElement.getBoundingClientRect(),r,this.viewportPadding,this.gap,this.softMargin,T,this.isRTL)}this.effectivePlacement=o.placement;let O=o.top,n=o.left;const h=G(this);if(h){const{scale:r}=k(h);n=(n-h.getBoundingClientRect().left)/r,O=(O-h.getBoundingClientRect().top)/r}this.applyPosition(this.tooltipElement,n,O),requestAnimationFrame(()=>{i=this.isTargetElementVisible(e,T,this.viewportPadding),this.tooltipElement&&(this.tooltipElement.style.visibility="visible")})}}connectedCallback(){super.connectedCallback(),this.effectivePlacement=this.placement,this.effectiveType=this.tooltipType,this.detachListeners(),this.attachListeners()}firstUpdated(){this.startObservers()}disconnectedCallback(){super.disconnectedCallback(),this.unmount()}updated(e){(e.has("show")||e.has("tooltiptext")||e.has("tooltipSize")||e.has("tooltipType")||e.has("placement"))&&this.show&&this.isTargetVisible&&(this.attachA11y(),this.scheduleTooltipPositionUpdate())}attachListeners(){window.addEventListener("scroll",this._scheduleTooltipPositionUpdateHandler,{passive:!0}),window.addEventListener("resize",this._scheduleTooltipPositionUpdateHandler,{passive:!0,capture:!0}),window.visualViewport&&(visualViewport==null||visualViewport.addEventListener("resize",this._scheduleTooltipPositionUpdateHandler,{passive:!0}),visualViewport==null||visualViewport.addEventListener("scroll",this._scheduleTooltipPositionUpdateHandler,{passive:!0}))}detachListeners(){window.removeEventListener("scroll",this._scheduleTooltipPositionUpdateHandler),window.removeEventListener("resize",this._scheduleTooltipPositionUpdateHandler),window.visualViewport&&(visualViewport==null||visualViewport.removeEventListener("resize",this._scheduleTooltipPositionUpdateHandler),visualViewport==null||visualViewport.removeEventListener("scroll",this._scheduleTooltipPositionUpdateHandler))}startObservers(){this.startTargetIntersectionObserver(),this._targetResizeObserver=new ResizeObserver(this.scheduleTooltipPositionUpdate),this._targetResizeObserver.observe(this.targetElement),this.show&&(this._tooltipResizeObserver=new ResizeObserver(this.scheduleTooltipPositionUpdate),this._tooltipResizeObserver.observe(this.tooltipElement));const e=G(this);e&&(this._ancestorResizeObserver=new ResizeObserver(this.scheduleTooltipPositionUpdate),this._ancestorResizeObserver.observe(e))}stopObservers(){var e,T,i,s;(e=this._targetIntersectionObserver)==null||e.disconnect(),this._targetIntersectionObserver=null,(T=this._targetResizeObserver)==null||T.disconnect(),this._targetResizeObserver=null,(i=this._tooltipResizeObserver)==null||i.disconnect(),this._tooltipResizeObserver=null,(s=this._ancestorResizeObserver)==null||s.disconnect(),this._ancestorResizeObserver=null}unmount(){this.rafId!==null&&cancelAnimationFrame(this.rafId),this._targetDismissTimer&&(clearTimeout(this._targetDismissTimer),this._targetDismissTimer=null),this.detachListeners(),this.stopObservers()}startTargetIntersectionObserver(){var s;const i={root:null,rootMargin:`-${this.viewportPadding}px`,threshold:[0,.01]};(s=this._targetIntersectionObserver)==null||s.disconnect(),this._targetIntersectionObserver=new IntersectionObserver(this.onTargetVisibility,i),this._targetIntersectionObserver.observe(this.targetElement)}getTooltipTextParts(){return`${E.TOOLTIP_TEXT} ${this.effectiveType} ${this.tooltipSize} ${this.effectivePlacement}`}readVisibleViewportBox(){if(window.visualViewport){const T=window.visualViewport;return{left:T.offsetLeft,top:T.offsetTop,right:T.offsetLeft+T.width,bottom:T.offsetTop+T.height,width:T.width,height:T.height}}const e=document.documentElement;return{left:0,top:0,right:e.clientWidth,bottom:e.clientHeight,width:e.clientWidth,height:e.clientHeight}}computeAvailableWidth(e,T,i,s,o){let O=i.width-2*s;return e.startsWith("tooltip-left")?O=Math.min(O,T.left-s-o):this.placement.startsWith("tooltip-right")&&(O=Math.min(O,i.right-s-(T.right+this.gap))),Math.max(this.minimumWidth,Math.floor(O))}async measureSingleLineWidth(e){const T=this.tooltipElement.style.cssText;e.style.visibility="hidden",e.style.whiteSpace="nowrap",e.style.maxWidth="none",e.style.overflow="visible",await this.updateComplete;const i=Math.round(this.tooltipElement.scrollWidth);return e.style.cssText=T,i}decideEffectiveType(e,T,i){if(e===null)return p.TOOLTIP_MULTI_LINE;const s=Math.round(T);return i===p.TOOLTIP_SINGLE_LINE?e>s?p.TOOLTIP_MULTI_LINE:p.TOOLTIP_SINGLE_LINE:p.TOOLTIP_MULTI_LINE}applySingleSizing(e,T){return e.style.whiteSpace="nowrap",e.style.overflowWrap="",e.style.maxWidth=`${T}px`,e.style.maxHeight="",e.style.overflow="visible",{maxWidth:T}}applyMultiSizing(e,T,i,s,o){e.style.whiteSpace="normal";const O=Math.max(this.minimumWidth,Math.min(o,T)),n=i-2*s;return e.style.maxWidth=`${T}px`,e.style.maxHeight="",e.style.overflow="visible",e.style.maxWidth=`${O}px`,e.style.maxHeight=`${n}px`,{maxWidth:O,maxHeight:n}}async runSizing(e,T,i,s){const o=this.computeAvailableWidth(e,T,i,this.viewportPadding,this.gap),n=this.tooltipType===p.TOOLTIP_SINGLE_LINE?await this.measureSingleLineWidth(this.tooltipElement):null,h=this.decideEffectiveType(n,o,this.tooltipType);if(this.effectiveType=h,this.effectiveType===p.TOOLTIP_SINGLE_LINE){const{maxWidth:r}=this.applySingleSizing(this.tooltipElement,o);return{effectiveType:h,availableWidth:o,appliedMaxWidth:r,singleLineWidth:n}}else if(this.effectiveType===p.TOOLTIP_MULTI_LINE){const{maxWidth:r,maxHeight:_}=this.applyMultiSizing(this.tooltipElement,o,i.height,s,this.multiLineMaxWidth);return{effectiveType:h,availableWidth:o,appliedMaxWidth:r,appliedMaxHeight:_,singLineWidth:this.tooltipType===p.TOOLTIP_SINGLE_LINE?n:void 0}}}applyPosition(e,T,i){e.style.left=`${Math.round(T)}px`,e.style.top=`${Math.round(i)}px`}isTargetElementVisible(e,T,i){const s=T.left+i,o=T.top+i,O=T.right-i,n=T.bottom-i,h=Math.max(0,Math.min(e.right,O)-Math.max(e.left,s)),r=Math.max(0,Math.min(e.bottom,n)-Math.max(e.top,o));return h>0&&r>0}attachA11y(){this.tooltipElement.setAttribute("role","tooltip"),this.targetElement.setAttribute("aria-describedby",`tooltip${this.componentId}`)}render(){return b`
      <div 
        part=${E.TOOLTIP_ROOT}
        @pointerleave=${this.handleMouseLeave}
        @focusout=${this.handleBlur}
      >
        ${this.show?b`
            <div
              id="tooltip${this.componentId}"
              data-testid="tooltip-text"
              part=${this.getTooltipTextParts()}
              class='tooltip'
              role='tooltip'
            >
              <slot name="tooltip">
                ${this.tooltiptext===void 0?S:this.tooltiptext}
              </slot>
            </div>`:S}
        <div id="target${this.componentId}" class='target'>
          <slot
            name="target"
            part=${E.TOOLTIP_TARGET}
            @pointerenter=${this.handleMouseOver}
            @focusin=${this.handleFocus}
          >
          </slot>
        </div>
      </div>
    `}};a([P({type:Boolean,reflect:!0})],l.prototype,"show",2);a([P({type:String})],l.prototype,"tooltiptext",2);a([P({type:String,reflect:!0})],l.prototype,"tooltipSize",2);a([P({type:String,reflect:!0})],l.prototype,"tooltipType",2);a([P({type:String,reflect:!0})],l.prototype,"placement",2);a([P({type:Number})],l.prototype,"gap",2);a([P({type:Number})],l.prototype,"multiLineMaxWidth",2);a([P({type:Number})],l.prototype,"viewportPadding",2);a([P({type:Number})],l.prototype,"minimumWidth",2);a([P({type:Boolean})],l.prototype,"isRTL",2);a([m()],l.prototype,"componentId",2);a([m()],l.prototype,"effectivePlacement",2);a([m()],l.prototype,"effectiveType",2);a([m()],l.prototype,"softMargin",2);a([m()],l.prototype,"isTargetVisible",2);a([m()],l.prototype,"rafId",2);a([W(".tooltip")],l.prototype,"tooltipElement",2);a([W(".target")],l.prototype,"targetElement",2);l=a([B("dx-tooltip")],l);
